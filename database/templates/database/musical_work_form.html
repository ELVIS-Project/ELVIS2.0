{% extends "database/base.html" %}
{% load i18n %}
{% load widget_tweaks %}
{% load template_helpers %}
{% load assign_value %}
{% load increment %}
{% block content %}
    <style>
        #form1 {
            display: none;
        }

        #form2 {
            display: none
        }

        #form3 {
            display: none
        }

        #form4 {
            display: none
        }

        #form5 {
            display: none
        }

        #form6 {
            display: none
        }

        #createContributor1 {
            display: none
        }

        #createContributor2 {
            display: none
        }

        #createContributor3 {
            display: none
        }

        #newContributorButton1 {
            display: none
        }

        #newContributorButton2 {
            display: none
        }

        #newContributorButton3 {
            display: none
        }

        #newSourceButton {
            display: none
        }

        #createSource {
            display: none
        }
    </style>
    <script>
        function copy_options(name){
        {#    This copys the options for the new "Attach To" tab #}
            var to = document.getElementsByName(name)[0];
            var from = document.getElementsByClassName('section_selected')[0];
            for (j = 1; j < from.options.length; j++) {
                    to.options.add(new Option(from.options[j].text, from.options[j].value))
                }
        }
        function update_attachTo(name) {
            var section_selected = document.getElementsByClassName('section_selected'); {# This gets an array! #}
            var the_input_title = document.getElementsByName(name);
            for (i = 0; i < section_selected.length; i++)
            {
                if (section_selected[i].options.length <= parseInt(name[name.length-1]))
            {# If the current option is not existant, create one #}
            {
                section_selected[i].options.add(new Option(the_input_title[0].value, name));
            }
            else
            {# If the option already exists, change the value when the input field changes #}
            {
                section_selected[i].options[parseInt(name[name.length-1])].text = the_input_title[0].value
                section_selected[i].options[parseInt(name[name.length-1])].value = name
            }
            }
        }
        function delete_option(name) {
            var section_selected = document.getElementsByClassName('section_selected');
            for (i = 0; i < section_selected.length; i++) {
                for (j = 0; j < section_selected[i].options.length; j++) {
                    if (section_selected[i].options[j].value == name) {
                        section_selected[i].options[j] = null;
                    }
                }
            }
            {#section_selected.options[value=name] = null;#}
        }
        function add_option() {
            var filled_section_div = document.getElementById("fill_section");
            var number = filled_section_div.getElementsByTagName("input").length / 2; {# Since we have 2 input elements here #}
            var section_selected = document.getElementsByClassName('section_selected');
            for (i = 0; i < section_selected.length; i++) {
                section_selected[i].options.add(new Option(filled_section_div.getElementsByTagName("input")[(number - 1) * 2].value, "title_section" + (number).toString()));
            }
        }
        $(document).ready(function () {
            $("input[placeholder]").each(function () {
                $(this).attr('size', $(this).attr('placeholder').length);
            });

            $('[data-toggle="popover"]').popover();

            function matchStart(params, data) { // params term is the word you input
                // If there are no search terms, return all of the data
                if ($.trim(params.term) === '') {
                    return data;
                }

                // In our cases, we don't have hierarchial data, so we dont have data.children
                var filteredChildren = [];
                var words = data.text.split(" ")  // Words save the name of each entry
                if (data.text.toUpperCase().indexOf(params.term.toUpperCase()) == 0) {
                    filteredChildren.push(data);
                }
                {# This matches the beginning of the item #}
                if (data.text.toUpperCase().indexOf(params.term.toUpperCase()) > 0) {
                    if (data.text[data.text.toUpperCase().indexOf(params.term.toUpperCase()) - 1] == ' ') {
                        filteredChildren.push(data);
                    }
                }
                {# This matches non-beginning of the item, but the search item needs to be at least the beginning of each word in the item #}
                if (filteredChildren.length) {
                    var modifiedData = [];  // use this because we dont have nested data!
                    modifiedData.children = filteredChildren;
                    return modifiedData;
                }
                // Return `null` if the term should not be displayed
                return null;
            }

            $("#select_menu").select2({
                matcher: matchStart,
                language: {
                    noResults: function () {
                        return "<a href='#'>Confirm the addition of a new item</a>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_geographical_area").select2({
                matcher: matchStart,
                placeholder: 'e.g., Vienna',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a geographical area</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_geographical_area1").select2({
                matcher: matchStart,
                placeholder: 'e.g., Vienna',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a geographical area</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_geographical_area2").select2({
                matcher: matchStart,
                placeholder: 'e.g., Vienna',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a geographical area</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_geographical_area3").select2({
                matcher: matchStart,
                placeholder: 'e.g., Vienna',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a geographical area</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_geographical_area4").select2({
                matcher: matchStart,
                placeholder: 'e.g., Vienna',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a geographical area</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_geographical_area5").select2({
                matcher: matchStart,
                placeholder: 'e.g., Vienna',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a geographical area</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $(".select_menu_geographical_area").select2({
                width: 'resolve',
                placeholder: 'e.g., Vienna',
                matcher: matchStart,
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a geographical area</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_contributor").select2({
                matcher: matchStart,
                placeholder: "e.g., Ludwig van Beethoven (1770-1827)",
                language: {
                    noResults: function () {
                        if ($('#newContributorButton1').css('display') == 'none')
                            $('#newContributorButton1').css('display', 'block');
                        return "<div style='color: red;'>Click 'New Contributor' to confirm the addition</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_contributor1").select2({
                matcher: matchStart,
                placeholder: "e.g., Ludwig van Beethoven (1770-1827)",
                language: {
                    noResults: function () {
                        if ($('#newContributorButton2').css('display') == 'none')
                            $('#newContributorButton2').css('display', 'block');
                        return "<div style='color: red;'>Click 'New Contributor' to confirm the addition</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $(".select_menu_contributor").select2({
                {#width: 'resolve',#}
                matcher: matchStart,
                placeholder: "e.g., Ludwig van Beethoven (1770-1827)",
                language: {
                    noResults: function () {
                        if ($('#newContributorButton3').css('display') == 'none')
                            $('#newContributorButton3').css('display', 'block');
                        return "<div style='color: red;'>Click 'New Contributor' to confirm the addition</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $(".select_menu_genre_as_in_type").select2({
                matcher: matchStart,
                placeholder: 'e.g., Symphony',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a new genre (type)</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $(".select_menu_institution").select2({
                matcher: matchStart,
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a new institution</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $(".select_menu_genre_as_in_style").select2({
                matcher: matchStart,
                placeholder: 'e.g., Classical music',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a new genre (style)</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });

            $(".select_menu_instrument").select2({
                matcher: matchStart,
                placeholder: 'e.g., Flute',
                tags: true,
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    if (term[term.length - 1] === ',') {
                        return {
                            id: term,
                            text: term.slice(0, -1),
                            newTag: true // add additional parameters
                        }
                    }
                },
                language: {
                    noResults: function () {
                        return "<div style='color: red;'>Append comma to confirm the addition of a new instrument</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $("#select_menu_collection_of_sources").select2({
                matcher: matchStart,
                placeholder: "e.g., The Nine Symphonies by Beethoven, published by Baerenreiter",
                language: {
                    noResults: function () {
                        if ($('#newSourceButton').css('display') == 'none')
                            $('#newSourceButton').css('display', 'block');
                        return "<div style='color: red;'>Click on \"NEW SOURCE\" to confirm the addition of a new source</div>";
                    }
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            });
            $('#addForm').click(function () {
                if ($('#form1').css('display') == 'none') {
                    $('#form1').css('display', 'block');
                    return;
                }
                if ($('#form2').css('display') == 'none') {
                    $('#form2').css('display', 'block');
                    return;
                }
                if ($('#form3').css('display') == 'none') {
                    $('#form3').css('display', 'block');
                    return;
                }
                if ($('#form4').css('display') == 'none') {
                    $('#form4').css('display', 'block');
                    return;
                }
                if ($('#form5').css('display') == 'none') {
                    $('#form5').css('display', 'block');
                    return;
                }
                if ($('#form6').css('display') == 'none') {
                    $('#form6').css('display', 'block');
                    return;
                }
            });
            $('#addContributor1').click(function () {
                $('#createContributor1').toggle()

            });
            $('#addContributor2').click(function () {
                $('#createContributor2').toggle()

            });
            $('#addContributor3').click(function () {
                $('#createContributor3').toggle()

            });
            $('#addSource').click(function () {
                $('#createSource').toggle()

            });
            $('#removeItself1').click(function () {
                if ($('#form1').css('display') == 'block')
                    $('#form1').css('display', 'none');
            });
            $('#removeItself2').click(function () {
                if ($('#form2').css('display') == 'block')
                    $('#form2').css('display', 'none');
            });
            $('#removeItself3').click(function () {
                if ($('#form3').css('display') == 'block')
                    $('#form3').css('display', 'none');
            });
            $('#removeItself4').click(function () {
                if ($('#form4').css('display') == 'block')
                    $('#form4').css('display', 'none');
            });
            $('#removeItself5').click(function () {
                if ($('#form5').css('display') == 'block')
                    $('#form5').css('display', 'none');
            });
            $('#removeItself6').click(function () {
                if ($('#form6').css('display') == 'block')
                    $('#form6').css('display', 'none');
            });
            $('#add_title').click(function () {
                var filled_title_div = document.getElementById("fill_title");
                var number_of_title = filled_title_div.getElementsByTagName("input").length + 1;
                var div = $("<div class=\"input-group\" id=\"filled_title\"/>");
                var delete_button = $("<button type=\"button\" class=\"btn btn-secondary\">-</button></div>");
                delete_button.click(function () {
                    $(this).parent().remove();
                });
                div.append('<span class="input-group-addon"  <strong>Variant title</strong></span>\n' +
                    '            <input type="text" name="title' + number_of_title + '" autocomplete="off" class="form-control"\n' +
                    '                   placeholder="e.g., Eroica" aria-label="Title">');
                div.append(delete_button);
                $("#fill_title").append(div);
            });
            $('#add_section').click(function () {
                var filled_section_div = document.getElementById("fill_section");
                var number = (filled_section_div.getElementsByTagName("input").length + 2) / 2;
                var div = $("<div class=\"input-group\" id=\"filled_section\"/>");
                var delete_button = $("<button type=\"button\" class=\"btn btn-secondary\">-</button></div>");
                delete_button.click(function () {
                    $(this).parent().remove();
                    delete_option("title_section" + number) {# delete the corresponding option in the attachment #}
                });
                div.append('<span class="input-group-addon"  <strong>Title</strong></span>\n' +
                    '            <input onkeyup="update_attachTo(this.name)" type="text" name="title_section' + number + '" maxlength="200" class="form-control" required id="id_title" \n' +
                    '                   >' + '<span class="input-group-addon"  <strong>Ordering</strong></span>\n' +
                    '<input type="number" name="ordering' + number + '" min="1" id="id_ordering" class="form-control"></div>');
                div.append(delete_button);
                $("#fill_section").append(div);
                add_option()
            });
            $('#add_file').click(function () {
                var filled_file_div = document.getElementById("fill_file");
                var number_of_files = filled_file_div.getElementsByTagName("input").length + 1;
                var number_of_attachTo = filled_file_div.getElementsByTagName("select").length + 1;
                var div = $("<div class=\"input-group\" id=\"filled_file\"/>");
                var delete_button = $("<button type=\"button\" class=\"btn btn-secondary\">-</button></div>");
                delete_button.click(function () {
                    $(this).parent().remove();
                });
                div.append(
                    '            <span class="input-group-addon"  <strong>Upload</strong></span>\n' +
                    '            <input type="file" name="file' + number_of_files + '" class="form-control" \n' +
                    '                   >' + '<span class="input-group-addon"  <strong>Attach To</strong></span>\n' +
                    '<select class="btn section_selected" name="attachTo' + number_of_attachTo + '"style=" border: 1px solid #ccc;; vertical-align: middle; background-color: #eee;"><option selected="selected">Musical Work</select></div>');
                div.append(delete_button);
                $("#fill_file").append(div);
                copy_options("attachTo" + number_of_attachTo)  {# copy options for the new tab for "Attach To" #}
                {#The section above adds a variant title field #}
            });
            {# The following code dynamically add options where the user wants to add the music files to#}


        })


    </script>
    <h1>Upload a Musical Work</h1>
    <form method="POST" class="post-form">
        {% csrf_token %}
        {% if form.non_field_errors %}
            <div class="alert alert-danger" role="alert">
                {% for error in form.non_field_errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}
        {#  Output all results from messages and let the user choose one result #}
        <div style="color: #cc0033;">
            {{ field.errors }}
        </div>
    </form>
    <br>
    <div id="upload-page-content">
        <form action="" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div id="fill_title">
                <div class="input-group"> <span class="input-group-addon" data-toggle="popover" data-placement="top"
                                                data-trigger="hover" data-html="true"
                                                title="&lt;b&gt;Title&lt;/b&gt;&lt;span class=&apos;badge badge-primary pull-right&apos;&gt;Required&lt;/span&gt;"
                                                data-content="Note: Duplicate titles will produce duplicate pieces in the database: this is to allow for composers who may have more than one piece with the same name.">Title:</span>
                    <input type="text" name="title1" autocomplete="off" class="form-control"
                           placeholder="e.g., Symphony No.3, Op. 55" aria-label="Title">
                    <span class="input-group-btn">
                    <button type="button" id="add_title" class="btn btn-secondary">+</button>
                </span>
                </div>

            </div>
            <br>
            <div>
                <div class="input-group">
                    {% for field in contribution_form %}
                        {% if field.label == 'Person' %}
                            <span class="input-group-btn" data-toggle="popover" data-placement="top"
                                  data-trigger="hover" data-html="true"
                                  title="Contributor&lt;span class=&apos;badge badge-primary pull-right&apos;&gt;Required&lt;/span&gt;"
                                  data-content="The role that this Person had in contributing. Can be one of: Composer, Arranger, Author of Text, Transcriber, Improviser, Performer">
                                <select name="role1" class="btn"
                                        style=" border: 1px solid #ccc;; vertical-align: middle; background-color: #eee;">
                                <option selected="selected">Composer</option>
                                <option>Arranger</option>
                                <option>Author of Text</option>
                                <option>Transcriber</option>
                                <option>Improviser</option>
                                <option>Performer</option>
                                </select>
                            </span>
                            <select name="person_selected1" multiple="multiple" style="width: 50%" class="form-control"
                                    id="select_menu_contributor">
                                {% for choice in field.field.choices %}
                                    {% if choice.1 != '---------' %}
                                        <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                            {#                            {% render_field field name="person_selected" multiple="multiple" style="width: 50%" class="form-control" id="select_menu_contributor" %}#}
                            <button type="button" id="addForm" class="btn btn-secondary">+</button>
                            <div id="newContributorButton1">
                                <button type="button" id="addContributor1" class="btn btn-secondary">New Contributor
                                </button>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <div id="createContributor1">
                    <hr>
                    {% for field in person_form %}
                        <div class="input-group">
                            {% if field.field.required %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="{{ field.help_text }}"><strong
                                        style="height: 20px;">{{ field.label }}</strong></span>
                            {% else %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                      data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                            {% endif %}
                            {% if field.label == 'Given name' %}
                                {#                                This is a required field, and we don't want that #}
                                <input type="text" class="form-control" name="given_name1" maxlength="100">
                            {% elif field.label == 'Surname' %}
                                {#                                This is a required field, and we don't want that #}
                                <input type="text" class="form-control" name="surname1" maxlength="100">
                            {% elif field.label == 'Range date birth' %}
                                <input type="text" name="range_date_birth1" placeholder="e.g., 1700-1701"
                                       class="form-control">
                            {% elif field.label == 'Range date death' %}
                                <input type="text" name="range_date_death1" placeholder="e.g., 1750-1751"
                                       class="form-control">
                            {% elif field.label == 'Birth location' %}
                                <select name="birth_location1" multiple="multiple" style="width: 50%"
                                        class="form-control" id="select_menu_geographical_area2">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            {% elif field.label == 'Death location' %}
                                <select name="death_location1" multiple="multiple" style="width: 50%"
                                        class="form-control" id="select_menu_geographical_area3">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            {% elif field.label == 'Authority control url' %}
                                <input type="url" name="person_authority_control_url1" maxlength="200"
                                       class="form-control" id="id_authority_control_url">
                            {% else %}
                                {% render_field field class="form-control" %}
                            {% endif %}
                        </div>
                    {% endfor %}

                    <hr>
                </div>
                <div class="input-group">
                    {% for field in contribution_form %}

                        {% if field.label == 'Certainty of attribution' or field.label == ' date' or field.label == 'Location' %}
                            {% if field.field.required %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="{{ field.help_text }}"><strong
                                        style="height: 20px;">{{ field.label }}</strong></span>
                            {% else %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                      data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                            {% endif %}
                            {% if field.label == 'Certainty of attribution' %}
                                <div style='padding-right:  20px; padding-left: 10px'>
                                    <input type="radio" name="certainty_of_attribution1"  id="certain"
                                    value="true" checked>
                                    <label class="input-group-addon" for="certain">
                                        <strong>Yes</strong>
                                    </label>
                                    <input type="radio" name="certainty_of_attribution1" id="uncertain"
                                           value="false">
                                    <label class="input-group-addon" for="uncertain">
                                        <strong>No</strong>
                                    </label>
                                </div>
                            {% elif field.label == ' date' %}
                                <input type="number" name="contribution_start_date1" placeholder="YYYY"
                                       style="text-align: center" class="form-control"/>–
                                <input type="number" name="contribution_end_date1" placeholder="YYYY"
                                       style="text-align: center; margin-left: 0px;" class="form-control"/>
                            {% elif field.label == 'Location' %}
                                <select name="contribution_location1" multiple="multiple" class="form-control"
                                        id="select_menu_geographical_area">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </div>

            </div>
            <div id="form1">
                {% for field in contribution_form %}
                    <div class="input-group">
                        {% if field.label == 'Person' %}
                            <span class="input-group-btn" data-toggle="popover" data-placement="top"
                                  data-trigger="hover" data-html="true"
                                  title="Contributor&lt;span class=&apos;badge badge-primary pull-right&apos;&gt;Required&lt;/span&gt;"
                                  data-content="The role that this Person had in contributing. Can be one of: Composer, Arranger, Author of Text, Transcriber, Improviser, Performer">
                            <select name="role2" class="btn"
                                    style=" border: 1px solid #ccc;; vertical-align: middle; background-color: #eee;">
                            <option selected="selected">Composer</option>
                            <option>Arranger</option>
                            <option>Author of Text</option>
                            <option>Transcriber</option>
                            <option>Improviser</option>
                            <option>Performer</option>
                            </select>
                        </span>
                            <select name="person_selected2" multiple="multiple" style="width: 50%" class="form-control"
                                    id="select_menu_contributor1">
                                {% for choice in field.field.choices %}
                                    {% if choice.1 != '---------' %}
                                        <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                            {#                            {% render_field field multiple="multiple" style="width: 50%" class="form-control" id="select_menu_contributor1" %}#}
                            <button type="button" id="removeItself1" class="btn btn-secondary">-</button>
                            <div id="newContributorButton2">
                                <button type="button" id="addContributor2" class="btn btn-secondary">New Contributor
                                </button>
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}

                <div id="createContributor2">
                    <hr>
                    {% for field in person_form %}
                        <div class="input-group">
                            {% if field.field.required %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="{{ field.help_text }}"><strong
                                        style="height: 20px;">{{ field.label }}</strong></span>
                            {% else %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                      data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                            {% endif %}
                            {% if field.label == 'Given name' %}
                                {#                                This is a required field, and we don't want that #}
                                <input type="text" class="form-control" name="given_name2" maxlength="100">
                            {% elif field.label == 'Surname' %}
                                {#                                This is a required field, and we don't want that #}
                                <input type="text" class="form-control" name="surname2" maxlength="100">
                            {% elif field.label == 'Range date birth' %}
                                <input type="text" name="range_date_birth2" placeholder="e.g., 1700-1701"
                                       class="form-control">
                            {% elif field.label == 'Range date death' %}
                                <input type="text" name="range_date_death2" placeholder="e.g., 1750-1751"
                                       class="form-control">
                            {% elif field.label == 'Birth location' %}
                                <select name="birth_location2" multiple="multiple" style="width: 50%"
                                        class="form-control" id="select_menu_geographical_area4">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            {% elif field.label == 'Death location' %}
                                <select name="death_location2" multiple="multiple" style="width: 50%"
                                        class="form-control" id="select_menu_geographical_area5">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            {% elif field.label == 'Authority control url' %}
                                <input type="url" name="person_authority_control_url2" maxlength="200"
                                       class="form-control" id="id_authority_control_url">
                            {% else %}
                                {% render_field field class="form-control" %}
                            {% endif %}
                        </div>
                    {% endfor %}
                    <hr>
                </div>
                <div class="input-group">
                    {% for field in contribution_form %}
                        {% if field.label == 'Certainty of attribution' or field.label == ' date' or field.label == 'Location' %}
                            {% if field.field.required %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="{{ field.help_text }}"><strong
                                        style="height: 20px;">{{ field.label }}</strong></span>
                            {% else %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                      data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                            {% endif %}
                            {% if field.label == 'Certainty of attribution' %}
                                <div style='padding-right:  20px; padding-left: 10px'>
                                    <input type="radio" name="certainty_of_attribution2" id="certain"
                                           value="true" checked>
                                    <label class="input-group-addon" for="certain">
                                        <strong>Yes</strong>
                                    </label>
                                    <input type="radio" name="certainty_of_attribution2" id="uncertain"
                                           value="false">
                                    <label class="input-group-addon" for="uncertain">
                                        <strong>No</strong>
                                    </label>
                                </div>
                            {% elif field.label == ' date' %}
                                <input name="contribution_start_date2" type="number" placeholder="YYYY"
                                       style="text-align: center" class="form-control"/>–
                                <input name="contribution_end_date2" type="number" placeholder="YYYY"
                                       style="text-align: center; margin-left: 0px;" class="form-control"/>
                            {% elif field.label == 'Location' %}
                                <select name="contribution_location2" multiple="multiple" style="width: 23.5%"
                                        class="form-control" id="select_menu_geographical_area1">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                                {#                                {% render_field field multiple="multiple" style="width: 23.5%" class="form-control" id="select_menu_geographical_area1" %}#}
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            <div id="form2">
                <div class="input-group">
                    {% for field in contribution_form %}
                        {% if field.label == 'Person' %}
                            <span class="input-group-btn" data-toggle="popover" data-placement="top"
                                  data-trigger="hover" data-html="true"
                                  title="Contributor&lt;span class=&apos;badge badge-primary pull-right&apos;&gt;Required&lt;/span&gt;"
                                  data-content="The role that this Person had in contributing. Can be one of: Composer, Arranger, Author of Text, Transcriber, Improviser, Performer">
                                <select name="role3" class="btn"
                                        style="border: 1px solid #ccc;; vertical-align: middle; background-color: #eee;">
                                <option selected="selected">Composer</option>
                                <option>Arranger</option>
                                <option>Author of Text</option>
                                <option>Transcriber</option>
                                <option>Improviser</option>
                                <option>Performer</option>
                                </select>
                            </span>
                            <select name="person_selected3" multiple="multiple" style="width: 50%"
                                    class="form-control select_menu_contributor">
                                {% for choice in field.field.choices %}
                                    {% if choice.1 != '---------' %}
                                        <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                            <button type="button" id="removeItself2" class="btn btn-secondary">-</button>
                            <div id="newContributorButton3">
                                <button type="button" id="addContributor3" class="btn btn-secondary">New Contributor
                                </button>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <div id="createContributor3">
                    <hr>
                    {% for field in person_form %}
                        <div class="input-group">
                            {% if field.field.required %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="{{ field.help_text }}"><strong
                                        style="height: 20px;">{{ field.label }}</strong></span>
                            {% else %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                      data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                            {% endif %}
                            {% if field.label == 'Given name' %}
                                {#                                This is a required field, and we don't want that #}
                                <input type="text" class="form-control" name="given_name3" maxlength="100">
                            {% elif field.label == 'Surname' %}
                                {#                                This is a required field, and we don't want that #}
                                <input type="text" class="form-control" name="surname3" maxlength="100">
                            {% elif field.label == 'Range date birth' %}
                                <input type="text" name="range_date_birth3" placeholder="e.g., 1700-1701"
                                       class="form-control">
                            {% elif field.label == 'Range date death' %}
                                <input type="text" name="range_date_death3" placeholder="e.g., 1750-1751"
                                       class="form-control">
                            {% elif field.label == 'Birth location' %}
                                <select name="birth_location3" multiple="multiple" style="width: 50%"
                                        class="form-control select_menu_geographical_area">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            {% elif field.label == 'Death location' %}
                                <select name="death_location3" multiple="multiple" style="width: 50%"
                                        class="form-control select_menu_geographical_area">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            {% elif field.label == 'Authority control url' %}
                                <input type="url" name="person_authority_control_url3" maxlength="200"
                                       class="form-control" id="id_authority_control_url">
                            {% else %}
                                {% render_field field class="form-control" %}
                            {% endif %}
                        </div>
                    {% endfor %}
                    <hr>
                </div>
                <div class="input-group">
                    {% for field in contribution_form %}
                        {% if field.label == 'Certainty of attribution' or field.label == ' date' or field.label == 'Location' %}
                            {% if field.field.required %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="{{ field.help_text }}"><strong
                                        style="height: 20px;">{{ field.label }}</strong></span>
                            {% else %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                      data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                            {% endif %}
                            {% if field.label == 'Certainty of attribution' %}
                                <div style='padding-right:  20px; padding-left: 10px'>
                                    <input type="radio" name="certainty_of_attribution3" id="certain"
                                           value="true" checked>
                                    <label class="input-group-addon" for="certain">
                                        <strong>Yes</strong>
                                    </label>
                                    <input type="radio" name="certainty_of_attribution3" id="uncertain"
                                           value="false">
                                    <label class="input-group-addon" for="uncertain">
                                        <strong>No</strong>
                                    </label>
                                </div>
                            {% elif field.label == ' date' %}
                                <input name="contribution_start_date3" type="text" placeholder="YYYY"
                                       style="text-align: center" class="form-control"/>–
                                <input name="contribution_end_date3" type="text" placeholder="YYYY"
                                       style="text-align: center; margin-left: 0px;" class="form-control"/>
                            {% elif field.label == 'Location' %}
                                <select name="contribution_location3" multiple="multiple" style="width: 23.5%"
                                        class="form-control select_menu_geographical_area">
                                    {% for choice in field.field.choices %}
                                        {% if choice.1 != '---------' %}
                                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                                {#                                {% render_field field multiple="multiple" style="width: 23.5%" class="form-control select_menu_geographical_area" %}#}
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            <br>
            <h2>Additional Information</h2>
            <hr>
            <span class="help-block">
            These fields make it easier to find the piece using the database search engine.
            </span>

            <div class="row">
                <div class="col-md-6">
                    <div class="row">

                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group" id="collections-input-group">
                                    {% for field in sources_form %}
                                        {% if field.label == 'Collection' %}
                                            {% if field.field.required %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>Sources</b><span class='badge badge-primary pull-right'>Required</span>"
                                                      data-content="{{ field.help_text }}"><strong
                                                        style="height: 20px;">Sources</strong></span>
                                            {% else %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>Sources</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                                      data-content="{{ field.help_text }}"><strong>Sources</strong></span>
                                            {% endif %}
                                            <select name="source_selected" multiple="multiple" style="width: 50%"
                                                    class="form-control" id="select_menu_collection_of_sources">
                                                {% for choice in field.field.choices %}
                                                    {% if choice.1 != '---------' %}
                                                        <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                            {#                                        {% render_field field multiple="multiple" style="width: 80%" class="form-control" id="select_menu_collection_of_sources" %}#}
                                        {% endif %}
                                    {% endfor %}
                                    <div id="newSourceButton">
                                        <button type="button" id="addSource" class="btn btn-secondary">New Source
                                        </button>
                                    </div>
                                </div>
                                <div id="collection_suggestion_menu" class="suggestion-div"></div>
                                <div id="collections_error"></div>
                            </div>
                            <div id="createSource">
                                <hr>
                                {% for field in collection_of_sources_form %}
                                    <div class="input-group">
                                        {% if field.field.required %}
                                            <span class="input-group-addon sync" data-toggle="popover"
                                                  data-placement="top"
                                                  data-trigger="hover"
                                                  data-html='true'
                                                  title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                                  data-content="{{ field.help_text }}"><strong
                                                    style="height: 20px;">{{ field.label }}</strong></span>
                                        {% else %}
                                            <span class="input-group-addon sync" data-toggle="popover"
                                                  data-placement="top"
                                                  data-trigger="hover"
                                                  data-html='true'
                                                  title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                                  data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                                        {% endif %}
                                        {% if field.label == 'Person publisher' %}
                                            <select name="person_publisher" multiple="multiple" style="width: 75%"
                                                    class="form-control select_menu_contributor">
                                                {% for choice in field.field.choices %}
                                                    {% if choice.1 != '---------' %}
                                                        <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                            {#                                            {% render_field field style="width: 75%" multiple="multiple" class="form-control select_menu_contributor" %}#}
                                        {% elif field.label == 'Institution publisher' %}
                                            <select name="institution_publisher" multiple="multiple" style="width: 75%"
                                                    class="form-control select_menu_institution">
                                                {% for choice in field.field.choices %}
                                                    {% if choice.1 != '---------' %}
                                                        <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                            {#                                            {% render_field field style="width: 75%" multiple="multiple" class="form-control select_menu_institution" %}#}
                                        {% elif field.label == 'Title' %}
                                            {#                                This is a required field, and we don't want that #}
                                            <input type="text" class="form-control" name="title_source_new"
                                                   maxlength="100">
                                        {% else %}
                                            {% render_field field class="form-control" %}
                                        {% endif %}
                                    </div>
                                {% endfor %}
                                <hr>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group">
                                    {% for field in musical_work_form %}
                                        {% if field.label == 'Genres as in type' %}
                                            {% if field.field.required %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                                      data-content="{{ field.help_text }}">{{ field.label }}</span>
                                            {% else %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                                      data-content="{{ field.help_text }}">{{ field.label }}</span>
                                            {% endif %}
                                            {% render_field field multiple="multiple" placeholder="e.g., Motet" class="form-control select_menu_genre_as_in_type" %}
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <div id="genre_suggestion_menu" class="suggestion-div"></div>
                                <div id="genres_error"></div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group">
                                    {% for field in musical_work_form %}
                                        {% if field.label == 'Genres as in style' %}
                                            {% if field.field.required %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                                      data-content="{{ field.help_text }}">{{ field.label }}</span>
                                            {% else %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                                      data-content="{{ field.help_text }}">{{ field.label }}</span>
                                            {% endif %}
                                            {% render_field field multiple="multiple" placeholder="e.g., Jazz" class="form-control select_menu_genre_as_in_style" %}
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <div id="genre_suggestion_menu" class="suggestion-div"></div>
                                <div id="genres_error"></div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group">
                                <span class="input-group-addon" data-toggle="popover" data-placement="top"
                                      data-trigger="hover" data-html='true'
                                      title="<b>Sacred/Secular</b> <span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="'Whether the Musical Work is'
                                                    ' secular or sacred. '
                                                    'Leave this blank if non '
                                                    'applicable.'">Sacred/Secular</span>
                                    {% for field in musical_work_form %}
                                        {% if field.label == ' sacred or secular' %}
                                            <select name="_sacred_or_secular" class="form-control"
                                                    id="id__sacred_or_secular">
                                                <option value="1" selected="">Not applicable</option>
                                                <option value="2">Sacred</option>
                                                <option value="3">Secular</option>
                                            </select>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <div id="genre_suggestion_menu" class="suggestion-div"></div>
                                <div id="genres_error"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group">
                                    {% for field in part_form %}
                                        {% if field.label == 'Written for' %}
                                            {% if field.field.required %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>Instrumentation</b><span class='badge badge-primary pull-right'>Required</span>"
                                                      data-content="{{ field.help_text }}">Instrumentation</span>
                                            {% else %}
                                                <span class="input-group-addon sync" data-toggle="popover"
                                                      data-placement="top"
                                                      data-trigger="hover"
                                                      data-html='true'
                                                      title="<b>Instrumentation</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                                      data-content="{{ field.help_text }}">Instrumentation</span>
                                            {% endif %}
                                            {% render_field field multiple="multiple" placeholder="e.g., Soprano" class="form-control select_menu_instrument" %}
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <div id="instrumentation_suggestion_menu" class="suggestion-div"></div>
                                <div id="instruments_voices_error"></div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group">
                                <span class="input-group-addon" data-toggle="popover" data-placement="top"
                                      data-trigger="hover" data-html='true'
                                      title="<b>Portions</b> <span class='badge badge-warning pull-right'>Optional</span>"
                                      data-content="Page or plate numbers from the source">Portions</span>
                                    <input type='text' name="portions" id="sources" autocomplete="off"
                                           placeholder="e.g., pp. 37-42"
                                           class="form-control unstyled upload-input-field" aria-label="Sources"/>
                                </div>
                                <div id="source_suggestion_menu" class="suggestion-div"></div>
                                <div id="sources_error"></div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group">
                                <span class="input-group-addon" data-toggle="popover" data-placement="top"
                                      data-trigger="hover" data-html='true'
                                      title="<b>Provenance</b> <span class='badge badge-warning pull-right'>Optional</span>"
                                      data-content="This is yet to be defined">Provenance</span>
                                    <input type='text' name="provenance" id="Provenance" autocomplete="off"
                                           placeholder="" class="form-control unstyled upload-input-field"
                                           aria-label="Sources"/>
                                </div>
                                <div id="source_suggestion_menu" class="suggestion-div"></div>
                                <div id="sources_error"></div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
            <br>

            <div class="form-group">
                {% for field in collection_of_sources_form %}
                    {% if field.label == 'Editorial notes' %}
                        {% render_field field class="form-control" placeholder="Comments..." %}
                    {% endif %}
                {% endfor %}
            </div>
            <br>
            <h2>Sections</h2>
            <hr>
            <span class="help-block">
                If the musical work is divided into sections, declare them in this table.
                Please enter titles for all sections, even if you will not be uploading files for all of them.
            </span>
            <div id="fill_section">
                <div class="input-group">
                    {% for field in section_form %}
                        {% if field.label == 'Title' or field.label == 'Ordering' %}
                            {% if field.field.required %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-primary pull-right'>Required</span>"
                                      data-content="{{ field.help_text }}"><strong
                                        style="height: 20px;">{{ field.label }}</strong></span>
                            {% else %}
                                <span class="input-group-addon sync" data-toggle="popover" data-placement="top"
                                      data-trigger="hover"
                                      data-html='true'
                                      title="<b>{{ field.label }}</b><span class='badge badge-secondary pull-right'>Optional</span>"
                                      data-content="{{ field.help_text }}"><strong>{{ field.label }}</strong></span>
                            {% endif %}
                            {% if field.label == 'Title' %}
                                <input type="text" maxlength="100" name="title_section1"
                                       placeholder="e.g., Allegro con brio"
                                       class="form-control" onkeyup="update_attachTo(this.name)">
                                {#                                {% render_field field name="title_section" placeholder="e.g., Allegro con brio" class="form-control" %} cannot specify name within render_field!#}
                            {% elif field.label == 'Ordering' %}
                                <input type="number" placeholder="e.g., 1" name="ordering1" min="1" id="id_ordering"
                                       class="form-control">
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                    <div>
                        <button id="add_section" type="button" class="btn btn-secondary">+</button>
                    </div>

                </div>

            </div>

            <br>
            <h2>Files</h2>
            <hr>
            <span class="help-block">
            Upload files with <a href="#" onClick="return false;" data-toggle="popover" data-placement="top"
                                 data-trigger="hover" title="<b>Acceptable Formats</b>"
                                 data-html='true'
                                 data-content=".mei, .xml, .pdf, .mxl, .krn, .nwc, .tntxt, .capx, .abc, .midi">
            acceptable formats</a> here. If the file is for a specific act or section as entered above, select that entry from the drop-down menu in the "Attach To" column.
            The files you upload will be renamed automatically.
        </span>

            <div class="input-group" id="fill_file">
                <span class="input-group-addon">Upload</span>
                <input type="file" name="file1" class="form-control">
                <span class="input-group-addon">Attach To</span>
                <select class="btn section_selected" name="attachTo1"
                        style=" border: 1px solid #ccc;; vertical-align: middle; background-color: #eee;">
                    <option selected="selected">Musical Work</option>
                </select>
                <span class="input-group-btn">
                    <button type="button" id="add_file" class="btn btn-secondary">+</button>
                </span>
            </div>

            <br>

            <hr>
            <div class="text-right">
                <button type="submit" class='btn btn-success'>Submit</button>
            </div>
            <br>
        </form>
    </div>

{% endblock %}

