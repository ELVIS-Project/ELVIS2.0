{% extends "database/base.html" %}
{% load i18n %}
{% load rest_framework %}
{% block content %}
{# TODO: Make the layout of the metadata better #}
<h2>{{ musicalwork.variant_titles.0 }}</h2>
    {% if musicalwork.variant_titles|length > 1 %}
        <b>Also known as: </b>
            {% for title in musicalwork.variant_titles|slice:"1:" %}
                {% if not forloop.first %}, {% endif %}
                {{ title }}
            {% endfor %}
    {% endif %}
<hr>
    <div class="panel panel-group">
        {% for composer_info in musicalwork.composers %}
            {% include "database/cards/contribution_card.html" with role='composer' url=composer_info.url date=composer_info.date place=composer_info.place certain=composer_info.certain person=composer_info.person%}
        {% endfor %}
    </div>
<div class="row">
    <div class="col-xs-6">
        <dl class="dl-horizontal">
            <!--Styles-->
            <dt>
                {% if musicalwork.genres_as_in_style.count > 1 %}
                    {%trans "Styles" %}
                {% else %}
                    {%trans "Style" %}
                {% endif %}
            </dt>
            <dd>
                {% for style in musicalwork.genres_as_in_style.all %}
                    <a href="{% url 'genre-detail' pk=style.pk %}">{{ style }}</a>
                {% endfor %}
            </dd>

            <!--Types-->
            <dt>
                {% if musicalwork.genres_as_in_type.count > 1%}
                    {% trans "Types" %}
                {% else %}
                    {% trans "Type" %}
                {% endif %}
            </dt>
            <dd>
                {% for type in musicalwork.genres_as_in_type.all %}
                    <a href="{% url 'genre-detail' pk=type.pk %}">{{ type }}</a>
                {% endfor %}
            </dd>
             <!--Religiosity-->
            <dt>
                {% trans "Religiosity" %}
            </dt>
            <dd>
                {% if musicalwork.religiosity == True %}
                    {% trans "Sacred" %}
                {% elif musicalwork.religiosity == False %}
                    {% trans "Secular" %}
                {% else %}
                    {% trans "Not Applicable" %}
                {% endif %}
            </dd>

            <!--Collections of Sources-->
            <dt>{% trans "Collections of Sources" %}</dt>
            <dd>
               {% for collection in musicalwork.collections  %}
                   <a href="{% url 'collection-detail' pk=collection.pk %}">{{ collection }}</a>
               {% endfor %}
            </dd>

            <!--Languages-->
            <dt>{% trans "Languages" %}</dt>
            <dd>
                {{ musicalwork.languages }}
            </dd>

        </dl>

    </div>
    <!--Sections-->
    <div class="col-sm-9">
        {% if musicalwork.sections.count %}
            <h3>{% trans 'Sections' %}
                <small>({{ musicalwork.sections.count }})</small>
            </h3>
            <hr>
            {% for s in musicalwork.sections.all %}
                <a href="{% url 'section-detail' pk=s.pk %}" class="list-group-item col-xs-11">
                <span class='badge alert-info right-badge' style='margin-top:10px'>
                    {{ s.parts.count }} {% include "database/translation_plural.html" with counts=s.parts.count single="Part" notsingle="Parts" %}
                </span>
                    <h4>
                        {{ s.title }}
                    </h4>
                    <p class='list-group-item-text'></p>
                </a>
            {% endfor %}
        {% endif %}
    </div>

    <!--Files-->
    <div class="col-sm-9">
        <h3>Files</h3>
        <hr>
            {% if musicalwork.symbolic_files|length > 0 %}
                <h4>Symbolic Files <small>({{  musicalwork.symbolic_files|length }})</small></h4>
                {% for file in musicalwork.symbolic_files %}
                    {% include 'database/cards/file_card.html' with file_name=file.file_name source=file.manifests file_type=file.file_type%}
                {% endfor %}
            {%  endif %}

            {% if musicalwork.image_files|length > 0 %}
                <h4>Images<small>({{  musicalwork.image_files|length }})</small></h4>
                {% for file in musicalwork.image_files %}
                    {% include 'database/cards/file_card.html' with file_name=file.file_name source=file.manifests file_type=file.file_type%}
                {% endfor %}
            {%  endif %}

            {% if musicalwork.audio_files|length > 0 %}
                <h4>Audio Files<small>({{  musicalwork.audio_files|length }})</small></h4>
                {% for file in musicalwork.audio_files %}
                    {% include 'database/cards/file_card.html' with file_name=file.file_name source=file.manifests file_type=file.file_type%}
                {% endfor %}
            {% endif %}

            {% if musicalwork.text_files|length > 0 %}
                <h4>Text Files<small>({{  musicalwork.text_files|length }})</small></h4>
                {% for file in musicalwork.text_files %}
                    {% include 'database/cards/file_card.html' with file_name=file.file_name source=file.manifests file_type=file.file_type%}
                {% endfor %}
            {% endif %}
    </div>



</div>

{% endblock %}
